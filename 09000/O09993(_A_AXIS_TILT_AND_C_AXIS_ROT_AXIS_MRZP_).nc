%
O09993( A AXIS TILT AND C AXIS ROT AXIS MRZP)

(DESIGNED TO PROBE 3 POINTS /-35 DEG /0 DEG /-55 DEG FOR B AXIS)
(DESIGNED TO PROBE 3 POINTS /0 /DEG /90 DEG /180 DEG FOR C AXIS)
(EACH LOCATION WILL BE PROBED TWICE FOR IMPROVED ACCURACY)
(MODIFIED PROGRAM TO FEED TO ROTARY PROBING LOCATIONS)
(CREATED BY ERIC RODRIGUEZ 7/21/2016)
(REVISED 12/2/2016)
(ADDED HOME POSITION RETURN)
(ADDED DPRNT OUTPUT)

( OUTPUT MRZP SETTING VALUES ) 
( COPY VALUE FROM THE MACRO VARIABLE INTO THE SETTING )
( MACRO #10121 IS SETTING 255 - MRZP X OFFSET )
( MACRO #10122 IS SETTING 256 - MRZP Y OFFSET ) 
( MACRO #10123 IS SETTING 257 - MRZP Z OFFSET ) 

(DPRNT- SETTING 261 MUST BE SET TO FILE)
(DPRNT- SETTING 262 MUST HAVE A PATH DESTINATION)

(NOT FOR USE ON COLDFIRE MACHINES) 
(PROGRAM CREATED FOR A AXIS TILT AND C AXIS ROTARY) 
(WORKS IN INCH AND METRIC)

( G65 P9993 A B C ) 
( A1 ROUGH A2 FINISH ) 
( B GAGE BALL DIAMETER FINISH CYCLE ) 
( C BORE DIAMETER ROUGH CYCLE ) 
 
( THIS PROGRAM WILL WRITE OVER) 
( G154 P90 AND G154 P91 )

(LIMIT LOOK AHEAD) 
G103 P1 
 
(SAFETY LINE) 
G90 G40 G80 G50 G69 
G255 G49 
 
( CLEAR G154 P90 OFFSETS ) 
#15781= 0 
#15782= 0 
#15783= 0 
#15784= 0 
#15785= 0 
 
( CLEAR G154 P91 OFFSETS ) 
#15801= 0 
#15802= 0 
#15803= 0 
#15804= 0 
#15805= 0  
 
( METRIC CHECK ) 
( CHECKS SETTING 9 )
#15643=#30003.078
#15643=#15643/25.4
#10997=500.
#5= 1. 
IF [ #20009 EQ 1 ] GOTO4 
GOTO5 
N4 
#15643=#15643*25.4
#10997=12700
#5= 25.4 
N5 
 
( A AND C AXIS HOME CHECK ) 
 
IF [ #5024 GT [ 0.02 ] ] GOTO904 
 
IF [ #5024 LT [ -0.02 ] ] GOTO904 
 
IF [ #5026 GT [ 0.02 ] ] GOTO905 
 
IF [ #5026 LT [ -0.02 ] ] GOTO905 
 
 
( A CALL CHECK ) 
 
IF [ #1 EQ 2 ] GOTO10 (FINISH CYCLE) 
 
IF [ #1 EQ 1 ] GOTO20 (ROUGH CYCLE) 
 
GOTO901 
 
(---------------------------------------) 
 
N10 (FINISH CYCLE ) 
 
( A CALL CHECK ) 
 
IF [ #2 LE 0 ] GOTO902 ( A CALL CHECK ) 
 
IF [ #2 EQ #0 ] GOTO902 ( A CALL CHECK ) 

(RECORD MACHINE ROTARY ZERO POINT) 
#10= #20255 ( SETTING 255 - MRZP X OFFSET )
#11= #20256 ( SETTING 256 - MRZP Y OFFSET ) 
#12= #20257 ( SETTING 257 - MRZP Z OFFSET ) 

( MACHINE ROTARY ZERO PARAM CHECK ) 
 
IF [ #10 EQ 0 ] GOTO906 
 
IF [ #10 EQ #0 ] GOTO906 
 
IF [ #11 EQ 0 ] GOTO907 
 
IF [ #11 EQ #0 ] GOTO907 
 
IF [ #12 EQ 0 ] GOTO908 
 
IF [ #12 EQ #0 ] GOTO908 
 
(PROBE TARGET OFFSET) 
G65 P9995 W154.9 A20. H - [ #2 * 0.5 ] 
G04 P1. 
G65 P9995 W154.9 A11. D#2 E - [ #2 * 0.65 ] 
 
(------------------------------------) 
 
( ROTATION ) 
 
(MOVE TO FIRST LOCATION)

G49 
G1G154P83Z0. F#10997

(G00 G90 G53 Z0.) 
G00 G90 G154 P90 X0. Y0. 
T#3026 
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ 0.25 * #5 ] F [ 100. * #5 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
 
G103 P1 

G49 
G1G154P83Z0. F#10997
 
(G00 G53 Z0.) 
G65 P9833 
G04 P300 
 
G103 P1 
 
(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#13= #15801 (X) 
#14= #15802 (Y) 
#15= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026 
 
(DIFFERENCE MRZP AND PROBE LOCATION) 
#16= #10 - #13 (X) 
#17= #11 - #14 (Y) 
#18= + [ #12 - #15 ] (Z) 

#10711= #13 (X)
#10721= #14 (Y)
(****************************************************) 
POPEN

DPRNT[UNITS*#4006[20]] 
DPRNT[TYPE*2] 
#10011= FIX[ #3011 / 10000 ] 
#10012= FIX[ [ #3011 - [ #10011 * 10000 ] ] / 100 ] 
#10013= FIX[ [ #3011 - [ #10011 * 10000 ] - [ #10012 * 100 ] ] / 1 ] 
DPRNT[DATE*20#10011[40]*#10012[20]*#10013[20]] 
#10011= FIX[ #3012 / 10000 ] 
#10012= FIX[ [ #3012 - [ #10011 * 10000 ] ] / 100 ] 
#10013= FIX[ [ #3012 - [ #10011 * 10000 ] - [ #10012 * 100 ] ] / 1 ] 
DPRNT[TIME*#10011[20]*#10012[20]*#10013[20]] 
DPRNT[AXISLABELS*A*B*C*X*Y*Z] 

#10011=#15804  
#10012=#15805 
#10013=#15806 
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

#10121= #20255
#10122= #20256
#10123= #20257

DPRNT[C AXIS]
DPRNT[OLD MRZP VALUES]
DPRNT[#10121[44]*#10122[44]*#10123[44]]
DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]]
(****************************************************)  
#15804=0
#15805=0 
#15806=0 
 
(------------------------------------) 
 
( SET SECOND LOCATION ) 
#15801= [ #10 - #17 ] (X) 
#15802= [ #11 + #16 ] (Y) 
 
(MOVE TO SECOND LOCATION) 

G49 
G1G154P83Z0. F#10997

G154 P91 
(G00 G90 G53 Z0.) 
G01 C90. X0. Y0. F#10997
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ #2 * 0.75 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z0. 
 
G103 P1 
 
G00 G154 P91 X0. Y0. 

(PROBE LOCATION 2) 
G04 P1. 
G65 P9810 Z [ #2 * 0.25 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
G103 P1
 
G49 
G1G154P83Z0. F#10997 

(G00 G53 Z0.) 
G65 P9833 
G04 P300  
 
G103 P1 
 
(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#21= #15801 (X) 
#22= #15802 (Y) 
#23= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026  
 
#10712= #21(X)
#10722= #22(Y)
 
(****************************************************) 
POPEN

#10011=#15804  
#10012=#15805 
#10013=#15806 
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]]
(****************************************************) 
#15804=0
#15805=0 
#15806=0 
 
(------------------------------------) 
 
( SET THIRD LOCATION ) 
#15801= [ #10 + #16 ] (X) 
#15802= [ #11 + #17 ] (Y) 
 
(MOVE TO THIRD LOCATION) 

G49 
G1G154P83Z0. F#10997
  
G154 P91
(G00 G53 Z0.) 
G01 C180. X0. Y0. F#10997
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ #2 * 0.75 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z0. 
 
G103 P1 
 
G00 G154 P91 X0. Y0. 

(PROBE LOCATION 2) 
G04 P1. 
G65 P9810 Z [ #2 * 0.25 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
G103 P1

G49 
G1G154P83Z0. F#10997
    
(G00 G53 Z0.) 
G65 P9833 
G04 P300  
 
(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#24= #15801 (X) 
#25= #15802 (Y) 
#26= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026  
 
#10713= #24 (X) 
#10723= #25 (Y) 

G103P1

#10711= [ ROUND[ #10711 * 10000 ] ] / 10000 
#10721= [ ROUND[ #10721 * 10000 ] ] / 10000 
#10712= [ ROUND[ #10712 * 10000 ] ] / 10000 
#10722= [ ROUND[ #10722 * 10000 ] ] / 10000 
#10713= [ ROUND[ #10713 * 10000 ] ] / 10000 
#10723= [ ROUND[ #10723 * 10000 ] ] / 10000

IF[#10712-#10711 EQ 0] THEN #10712=#10712+0.0001

IF[#10713-#10712 EQ 0] THEN #10713=#10713+0.0001

#10715=[[#10722]-[#10721]]/[[#10712]-[#10711]] 
#10716=[[#10723]-[#10722]]/[[#10713]-[#10712]]

#10714=[[[#10715]*[#10716]]*[[#10721]-[#10723]]+[[#10716]*[[#10711]+[#10712]]]-[[#10715]*[[#10712]+[#10713]]]]/[[2.]*[[#10716]-[#10715]]]

#10724=[[-1.]/[#10715]]*[[#10714]-[[#10711]+[#10712]]/[2.]]+[[#10721]+[#10722]]/[2.]

#10000= #10714(X) 
#10001= #10724(Y)
#10002= 0(Z)

(****************************************************) 
POPEN

#10011=#15804  
#10012=#15805 
#10013=#15806 
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]]
DPRNT[NEW MRZP VALUES]
DPRNT[#10000[44]*#10001[44]*#10002[44]]
DPRNT[END*DATA] 
PCLOS 
G103

(****************************************************)  
#15804=0
#15805=0 
#15806=0 
(------------------------------------) 
 
(MOVE BACK TO FIRST LOCATION) 

G49 
G1G154P83Z0. F#10997
   
(G00 G53 Z0.)
G01 C0. F#10997
G00 G53 X#13 Y#14 
 
(------------------------------------) 
 
(TILT )
 
(MOVE TO FIRST LOCATION) 

G49 
G1G154P83Z0. F#10997
 
(G00 G90 G53 Z0.) 
G00 G90 G154 P90 X0. Y0. 

#15801= #15781
#15802= #15782
#15803= #15783
#15804= #15784
#15805= #15785 

T#3026 
G43 H#3026 

(------------------------------------) 
 
( TILT 1) 
 
( CALC -35 DEG LOCATION) 
( TILT ) 
#20= [ #18 * SIN[ - 35 ] ] (y) 
#21= [ #18 * COS[ - 35 ] ] (Z) 
IF [ #16 GT 0 ] GOTO500 ( SINK OR LIFT) 
(SINK) 
#22= - [ #17 * COS[ 35 ] ] (y) 
#23= [ #17 * SIN[ 35 ] ] (Z) 
 
GOTO600 
N500 
(LIFT) 
#22= - [ #17 * COS[ 35 ] ] (y) 
#23= [ #17 * SIN[ 35 ] ] (Z) 
 
N600 
 
( SET FIXTURE LOCATION ) 
#15802= [ #11 + #20 + #22 ] (y) 
#15801= #13 (x) 
#15803= [ #12 - #21 + #23 ] (Z) 
 
(MOVE TO -35. DEG LOCATION)  
G49 
G1G154P83Z0. F#10997

G154 P91
(G00 G53 Z0.) 
G01 G154 P91 C0. A-35. X0. Y0. F#10997
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ #2 * 0.75 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G04 P300 
G65 P9814 S154.91 D#2 Z0. 
G103 P1 
 
G00 G154 P91 X0. Y0. 

(PROBE LOCATION 2) 
G04 P1. 
G65 P9810 Z [ #2 * 0.25 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
G103 P1 

G49 
G1G154P83Z0. F#10997

(G00 G53 Z0.) 
G65 P9833 
G04 P300  
 
G103 P1 

(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#24= #15801 (X) 
#25= #15802 (Y) 
#30= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026 

#27= #25 - #14 ( INC TO CENTER Y) 
#31= [ [ SQRT[ 3 ] ] * #27 ] ( INC TO CENTER Z) 
#31= [ ABS[ #31 ] ] 
 
#10712= #30(Z)
#10722= #25 (Y) 

(****************************************************) 
POPEN

DPRNT[UNITS*#4006[20]] 
DPRNT[TYPE*2] 
#10011= FIX[ #3011 / 10000 ] 
#10012= FIX[ [ #3011 - [ #10011 * 10000 ] ] / 100 ] 
#10013= FIX[ [ #3011 - [ #10011 * 10000 ] - [ #10012 * 100 ] ] / 1 ] 
DPRNT[DATE*20#10011[40]*#10012[20]*#10013[20]] 
#10011= FIX[ #3012 / 10000 ] 
#10012= FIX[ [ #3012 - [ #10011 * 10000 ] ] / 100 ] 
#10013= FIX[ [ #3012 - [ #10011 * 10000 ] - [ #10012 * 100 ] ] / 1 ] 
DPRNT[TIME*#10011[20]*#10012[20]*#10013[20]] 
DPRNT[AXISLABELS*A*B*C*X*Y*Z] 

#10011=#15804
#10012=#15805
#10013=#15806
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

#10121= #20255
#10122= #20256
#10123= #20257

DPRNT[A AXIS]
DPRNT[OLD MRZP VALUES]
DPRNT[#10121[44]*#10122[44]*#10123[44]]
DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]]
(****************************************************)  
#15804=0
#15805=0 
#15806=0 
 
(------------------------------------) 

(TILT 2)
 
(MOVE TO FIRST LOCATION) 

G49 
G1G154P83Z0. F#10997
 
(G00 G90 G53 Z0.) 
G00 G90 G154 P90 X0. Y0. A0. 
T#3026 
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ 0.25 * #5 ] F [ 100. * #5 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
 
G103 P1 

G00 G154 P91 X0. Y0. 

(PROBE LOCATION 2) 
G04 P1. 
G65 P9810 Z [ #2 * 0.25 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
G103 P1 

G49 
G1G154P83Z0. F#10997

(G00 G53 Z0.) 
G65 P9833 
G04 P300  
 
G103 P1 

(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#13= #15801 (X) 
#14= #15802 (Y) 
#15= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026  
 
(DIFFERENCE MRZP AND PROBE LOCATION) 
#16= #10 - #13 (X) 
#17= #11 - #14 (Y) 
#18= + [ #12 - #15 ] (Z) 
 
#10711=#15(Z)
#10721= #14 (Y) 

(****************************************************) 
POPEN

#10011=#15804  
#10012=#15805 
#10013=#15806 
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]] 
(****************************************************) 
#15804=0
#15805=0 
#15806=0 

(------------------------------------) 

( TILT 3)
 
( CALC 55 DEG LOCATION) 
( TILT ) 
#20= [ #18 * SIN[ 55 ] ] (y) 
#21= [ #18 * COS[ 55 ] ] (Z) 
IF [ #17 LT 0 ] GOTO300 ( SINK OR LIFT) 
(SINK) 
#22= - [ #17 * COS[ 55 ] ] (X) 
#23= - [ #17 * SIN[ 55 ] ] (Z) 
 
GOTO400 
N300 
(LIFT) 
#22= - [ #17 * COS[ 55 ] ] (y) 
#23= - [ #17 * SIN[ 55 ] ] (Z) 
 
N400 
 
( SET FIXTURE LOCATION ) 
#15802= [ #11 + #20 + #22 ] (y) 
#15801= #13 (x) 
#15803= [ #12 - #21 + #23 ] (Z) 
 
( MOVE TO 55 DEG LOCATION ) 

G49 
G1G154P83Z0. F#10997

(G00 G53 Z0.) 
G154 P91 
G01 G154 P91 A55. X0. Y0. F#10997 
G43 H#3026 
 
(PROBE LOCATION) 
G65 P9832 
G04 P1. 
G65 P9810 Z [ #2 * 0.75 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G04 P300 
G65 P9814 S154.91 D#2 Z0. 
G103 P1 

G00 G154 P91 X0. Y0. 

(PROBE LOCATION 2) 
G04 P1. 
G65 P9810 Z [ #2 * 0.25 ] 
G04 P300 
G65 P9811 S154.91 Z0. 
G04 P300 
G65 P9814 S154.91 D#2 Z - [ #2 / 2 ] 
G103 P1 

G49 
G1G154P83Z0. F#10997 

(G00 G53 Z0.) 
G65 P9833 
G04 P300  

G103 P1 
 
(MOVE Z OFFSET - HALF GAGE BALL DIAMETER) 
#15803= #15803 - [ #2 / 2 ] 
 
(RECORD PROBED LOCATION) 
#24= #15801 (X) 
#25= #15802 (Y) 
#26= #15803 (Z) 
#15804= #5024
#15805= #5025 
#15806= #5026 

#27= [ #25 - #14 ] ( INC TO CENTER X) 
#28= [ [ SQRT[ 3 ] ] * #27 ] ( INC TO CENTER Z) 
#28= [ ABS[ #28 ] ] 
 
#10713= #26(Z)
#10723= #25 (Y)  
 
(------------------------------------) 

G49 
G1G154P83Z0. F#10997

(G00 G90 G53 Z0.) 
G01 A0. F#10997
G00 G90 G53 X#13 Y#14 

GOTO9999 
 
(------------------------------------) 
 
N20 ( ROUGH CYCLE) 
 
( C CALL CHECK ) 
IF [ #3 LE 0 ] GOTO903 ( C CALL CHECK ) 
IF [ #3 EQ #0 ] GOTO903 ( C CALL CHECK ) 
( D CALL CHECK )
IF [[ #7 LT -360.]OR [#7 GT 360.]] GOTO903
IF [ #7 EQ #0] GOTO903
( E CALL CHECK )
IF [ #8 LT 0.]  GOTO903
IF [ #8 EQ #0] GOTO903
G65 P9832 
 
G91 G31 Z - [ 0.5 * #5 ] F [ 50. * #5 ]  
 
G65 P9995 W154.91 A10. D#3 
G04 P300 
 
G65 P9832  
 
G91 G31 Z [ 0.5 * #5 ] F [ 50. * #5 ] 

#24= [ [#3/2 + #8] * COS[#7] ]
#25= [ [#3/2 + #8] * SIN[#7] ]

G31 G91 X#24 Y#25 F [ 50. * #5 ] M78
 
G65 P9995 W154.91 A20. H - [ 0.5 * #5 ] 
G04 P300 

G65 P9832 
G31 G90 G154 P1 X0. Y0. F [ 50. * #5 ] 

G103 P1 
 
(RECORD PROBED LOCATION) 
#121= #15801 ( SETTING 255 - MRZP X OFFSET ) 
#122= #15802 ( SETTING 256 - MRZP Y OFFSET ) 
#123= #15803 ( SETTING 257 - MRZP Z OFFSET ) 
 
#123= [ #123 + #11 ] ( TABLE TO MRZP DISTANCE Z ADJUSTMENT ) 
 
( CONVERSION NO LONGER NEEDED )
(#106= [ #20255 * 25.4 / #5 ] X PARAMETER) 
(#107= [ #20256 * 25.4 / #5 ] Y PARAMETER) 
(#108= [ #20257 * 25.4 / #5 ] Z PARAMETER) 
 
GOTO8888
 
(--------------------------------------) 
 
N900 ( ALARMS ) 
 
N901 
#3000= 1 ( NO A CALL IN G65 LINE ) 
 
N902 
#3000= 2 ( NO B CALL IN G65 LINE ) 
 
N903 
#3000= 3 ( NO C CALL IN G65 LINE ) 
 
N904 
#3000= 4 (HOME A AXIS ) 
 
N905 
#3000= 5 (HOME C AXIS ) 
 
N906 
#3000= 6 (SETTING 255 IS 0 - RUN MRZP ROUGH 1ST & ENTER VALUE) 
 
N907 
#3000= 7 (SETTING 256 IS 0 - RUN MRZP ROUGH 1ST & ENTER VALUE) 
 
N908 
#3000= 8 (SETTING 257 IS 0 - RUN MRZP ROUGH 1ST & ENTER VALUE) 

N9999 

G103P1

#10711= [ ROUND[ #10711 * 10000 ] ] / 10000 
#10721= [ ROUND[ #10721 * 10000 ] ] / 10000 
#10712= [ ROUND[ #10712 * 10000 ] ] / 10000 
#10722= [ ROUND[ #10722 * 10000 ] ] / 10000 
#10713= [ ROUND[ #10713 * 10000 ] ] / 10000 
#10723= [ ROUND[ #10723 * 10000 ] ] / 10000

IF[#10712-#10711 EQ 0] THEN #10712=#10712+0.0001

IF[#10713-#10712 EQ 0] THEN #10713=#10713+0.0001

#10715=[[#10722]-[#10721]]/[[#10712]-[#10711]] 
#10716=[[#10723]-[#10722]]/[[#10713]-[#10712]]

#10714=[[[#10715]*[#10716]]*[[#10721]-[#10723]]+[[#10716]*[[#10711]+[#10712]]]-[[#10715]*[[#10712]+[#10713]]]]/[[2.]*[[#10716]-[#10715]]]

#10724=[[-1.]/[#10715]]*[[#10714]-[[#10711]+[#10712]]/[2.]]+[[#10721]+[#10722]]/[2.]

#10002= #10714(Z) 
#10003= #10724(Y) 

#10004= [ #10001 * - 1. ] - [ #10003 * - 1. ]
#10005= #10001
#10006= #10003

#10001= [ #10001 * - 1. ] + [ #10003 * - 1. ] 

#10001= #10001 / 2 

#10001= #10001 * -1. 

#10121=#10000
#10122=#10001
#10123=#10002

(****************************************************) 
POPEN

#10011=#15804  
#10012=#15805 
#10013=#15806 
#10016=#15801
#10017=#15802
#10018=#15803

#10011= [ ROUND[ #10011 * 10000 ] ] / 10000 
#10012= [ ROUND[ #10012 * 10000 ] ] / 10000 
#10013= [ ROUND[ #10013 * 10000 ] ] / 10000 
#10016= [ ROUND[ #10016 * 10000 ] ] / 10000 
#10017= [ ROUND[ #10017 * 10000 ] ] / 10000 
#10018= [ ROUND[ #10018 * 10000 ] ] / 10000 

DPRNT[#10011[44]*#10012[44]*#10013[44]*#10016[44]*#10017[44]*#10018[44]]
DPRNT[NEW FINAL MRZP VALUES]
DPRNT[#10121[44]*#10122[44]*#10123[44]]
DPRNT[END*DATA] 
PCLOS 
G103

(****************************************************)
#15804=0
#15805=0 
#15806=0 

(------------------------------------)

G28 A0. 
N8888
G103
M30 



%