%
O09820 (STOCK ALLOWANCE RENISHAW V3.11 FOR NGC)
G103 P1
#3001= 0
G04 P250
IF [ #3001 LT 200 ] GOTO999 (TEST RUNNING IN GRAPHICS)
G65 P9724
G65 P9725 A1.
IF [ #20 EQ #0 ] GOTO1
#3000= 91 (IJK INPUTS 5 MAX)
N1
#1= 185
WHILE [ #1 LE 199 ] DO1
#[ #1 ]= #0
#1= #1 + 1
END1
N10
#29= 0
IF [ #26 EQ #0 ] GOTO20
(Z MEAS)
#1= #5041
#2= #5042
#32= #5043 - #166
#30= -1
IF [ #32 LT #26 ] GOTO11
#30= 1
N11
G31 X#1 Y#2 F#169
#199= 1
IF [ #5041 - [ #1 ] GE #173 ] GOTO70
IF [ #5042 - [ #2 ] GE #173 ] GOTO70
G65 P9726 Z#26
IF [ #199 NE 0 ] GOTO70
#3= [ #176 - #166 - #26 ] * #30 (ERROR)
IF [ #29 NE 0 ] GOTO12
#194= #3
#195= #3
GOTO15
N12
IF [ #3 GT #194 ] GOTO13
IF [ #3 LT #195 ] GOTO14
GOTO15
N13
#194= #3 (STORE MAX)
GOTO15
N14
#195= #3 (STORE MIN)
N15
#1= #[ 4 + #29 ]
#2= #[ 5 + #29 ]
#29= #29 + 3
#192= #195 * #30
IF [ #1 EQ #0 ] GOTO40
IF [ #2 EQ #0 ] GOTO40
IF [ #29 LT 16 ] GOTO11
GOTO40
N20
IF [ #24 EQ #0 ] GOTO30
(X MEAS)
#1= #5042
#2= #5043 - #166
#32= #5041
#30= -1
IF [ #32 LT #24 ] GOTO21
#30= 1
N21
G31 Y#1 Z#2 F#169
#199= 1
IF [ #5043 - #166 - [ #2 ] GE #173 ] GOTO70
IF [ #5042 - [ #1 ] GE #173 ] GOTO70
G65 P9726 X#24 S #[ #161 ]
IF [ #199 NE 0 ] GOTO70
#3= #174 + #[ #161 + 2 ] - [ #[ #161 ] * #30 ]
#3= [ #3 - #24 ] * #30 (ERR)
IF [ #29 NE 0 ] GOTO22
#194= #3
#195= #3
GOTO25
N22
IF [ #3 GT #194 ] GOTO23
IF [ #3 LT #195 ] GOTO24
GOTO25
N23
#194= #3 (STORE MAX)
GOTO25
N24
#195= #3 (STORE MIN)
N25
#1= #[ 5 + #29 ]
#2= #[ 6 + #29 ]
#29= #29 + 3
#190= #195 * #30
IF [ #1 EQ #0 ] GOTO40
IF [ #2 EQ #0 ] GOTO40
IF [ #29 LT 16 ] GOTO21
GOTO40
N30
IF [ #25 EQ #0 ] GOTO72
(Y MEASURE)
#1= #5041
#2= #5043 - #166
#32= #5042
#30= -1
IF [ #32 LT #25 ] GOTO31
#30= 1
N31
G31 X#1 Z#2 F#169
#199= 1
IF [ #5043 - #166 - [ #2 ] GE #173 ] GOTO70
IF [ #5041 - [ #1 ] GE #173 ] GOTO70
#199= 0
G65 P9726 Y#25 S #[ #161 + 1 ]
IF [ #199 NE 0 ] GOTO70
#3= #175 + #[ #161 + 3 ] - [ #[ #161 + 1 ] * #30 ]
#3= [ #3 - #25 ] * #30 (ERR)
IF [ #29 NE 0 ] GOTO32
#194= #3
#195= #3
GOTO35
N32
IF [ #3 GT #194 ] GOTO33
IF [ #3 LT #195 ] GOTO34
GOTO35
N33
#194= #3 (STORE MAX)
GOTO35
N34
#195= #3 (STORE MIN)
N35
#1= #[ 4 + #29 ]
#2= #[ 6 + #29 ]
#29= #29 + 3
#191= #195 * #30
IF [ #1 EQ #0 ] GOTO40
IF [ #2 EQ #0 ] GOTO40
IF [ #29 LT 16 ] GOTO31
N40 (TOL CHECK)
#196= ABS[ #195 - #194 ]
IF [ #21 EQ #0 ] GOTO60
IF [ #19 EQ #0 ] GOTO50
N41 (U AND S)
IF [ #196 LT #21 ] GOTO42
#198= 6
N42
IF [ #170 AND 4 EQ 4 ] GOTO60
IF [ #196 LT #21 ] GOTO60
#[ 3006 - [ [ #170 AND 8 ] / 8 * 6 ] ]= 1 (EXCESS STOCK)
GOTO80
N50 (U ONLY)
IF [ #194 GT #21 ] GOTO51
IF [ #195 LT 0 ] GOTO51
GOTO52
N51
#198= 3
N52
IF [ #170 AND 4 EQ 4 ] GOTO60
IF [ #194 GT #21 ] GOTO53
IF [ #195 LT 0 ] GOTO53
GOTO60
N53
#[ 3006 - [ [ #170 AND 8 ] / 8 * 6 ] ]= 1 (UPPER TOL EXCEEDED)
GOTO80
N60
IF [ #19 EQ #0 ] GOTO80
G65 P9732 S#19 Z#26 W1.
GOTO80
N70
IF [ #199 NE 2 ] GOTO71
#3000= 93 (SURFACE NOT FOUND)
N71
#3000= 92 (UNEXPECTED SURFACE FOUND)
N72
#3000= 91 (XYZ INPUT MISSING)
N80
#190= #0
#191= #0
#192= #0
N999
G103
(G04 P1.0)
M99





%